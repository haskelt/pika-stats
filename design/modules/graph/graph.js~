{{ JS_COPYRIGHT_NOTICE }}

import d3 from '{{SITE_PATH}}/js/d3/d3.v6.5.0.js';

class Graph {

    /*------------------------------------------------------------------------*/

    static initialize () {

	this.data = [4, 8, 15, 16, 23, 42];
	this.graphElement = document.querySelector('#graph');
	this.makeGraph();
	
    } // initialize

    /*------------------------------------------------------------------------*/

    static makeGraph () {
	
	var width = 420;

	var x = d3.scaleLinear()
	    .domain([0, d3.max(this.data)])
	    .range([0, width])

	var y = d3.scaleBand()
	    .domain(d3.range(this.data.length))
	    .range([0, 20 * this.data.length])


	this.svg = d3.create("svg")
	      .attr("width", width)
	      .attr("height", y.range()[1])
	      .attr("font-family", "sans-serif")
	      .attr("font-size", "10")
	      .attr("text-anchor", "end");
	
	const bar = this.svg.selectAll("g")
	      .data(this.data)
	      .join("g")
	      .attr("transform", (d, i) => `translate(0,${y(i)})`)
	      .attr("class", "barGroup");
	
	bar.append("rect")
	    .attr("fill", "steelblue")
	    .attr("width", x)
	    .attr("height", y.bandwidth() - 1)
	    .attr("class", "bar");
	
	bar.append("text")
	    .attr("fill", "white")
	    .attr("x", d => x(d) - 3)
	    .attr("y", y.bandwidth() / 2)
	    .attr("dy", "0.35em")
	    .text(d => d);
	
	this.graphElement.appendChild(this.svg.node());
	
    } // makeGraph
	
    /*------------------------------------------------------------------------*/

    static updateValues (values) {

	for(let point in this.data){
	    this.data[point] = Math.random() * this.data[point];
	}
	// Update selection: Resize and position existing 
	// DOM elements with data bound to them.
	this.svg.selectAll(".barGroup").data(this.data).select(".bar")
	    .attr("width", function(d){ return d; });
//	    .style("height", function(d){ 
//		return d + "px"; 
//	    })
//	    .style("margin-top", function(d){ 
//		return (100 - d) + "px"; 
//	    });
	
    } // updateValues
    
    /*------------------------------------------------------------------------*/
    
} // Graph

Graph.initialize();
export default Graph;
